import{F as W,_ as P}from"./FileDropper-C6ZwNb_X.js";import{x as D,U as E,a6 as K,aA as Z,c as w,aB as j,H as $,aC as G,e as V,ab as A,d as L,T as O,u as Y,V as J,W as Q,o as N,z as k,b as t,n as X,a5 as ee,t as R,aD as te,ax as ae,ay as oe,A as x,h as B,F as se,p as v,w as T,a as ne,aE as le,_ as ue,l as H,az as q}from"./index-CZ5--WV8.js";import{_ as re}from"./BAlert.vue_vue_type_script_setup_true_lang-Bq9xl30a-DQFECoNi.js";import{u as ie,a as de}from"./useStateClass-BGbSLWFN-KtwBG7Qk.js";import{u as ce}from"./debounce-BHqBzJ1a-CaFKRnc6.js";import{a as me,g as fe}from"./misc-C-tqdJMj.js";import"./BCloseButton.vue_vue_type_script_setup_true_lang-byZmQ_ot-DpvVQpY4.js";const pe=(a,i)=>{if(a===null)return;let n=a;if(i.number&&typeof n=="string"&&n!==""){const e=Number.parseFloat(n);n=Number.isNaN(e)?n:e}return n},ve=(a,i,n,e)=>{const l=D(0),b=E(()=>a.id,"input"),p=V(()=>a.debounce??0,{nanToZero:!0}),f=V(()=>a.debounceMaxWait??Number.NaN),h=K(Z,null)?.(b),c=w(()=>a.state!==void 0?a.state:h?.state.value??null),o=ie(()=>a.ariaInvalid,c),y=de(c),d=ce(s=>{n.value=s},()=>e.lazy===!0?0:p.value,{maxWait:()=>e.lazy===!0?Number.NaN:f.value}),m=(s,u=!1,r=!1)=>{e.lazy===!0&&u===!1||(r?n.value=s:d(s))},{focused:_}=j(i,{initialValue:a.autofocus}),g=(s,u,r=!1)=>a.formatter!==void 0&&(!a.lazyFormatter||r)?a.formatter(s,u):s;return $(()=>{i.value&&(i.value.value=n.value?.toString()??"")}),G(()=>{A(()=>{a.autofocus&&(_.value=!0)})}),{input:i,computedId:b,computedAriaInvalid:o,onInput:s=>{const{value:u}=s.target,r=g(u,s);if(s.defaultPrevented){s.preventDefault();return}m(r)},onChange:s=>{const{value:u}=s.target,r=g(u,s);if(s.defaultPrevented){s.preventDefault();return}const I=r;n.value!==I&&m(r,!0)},onBlur:s=>{if(!e.lazy&&!a.lazyFormatter&&!e.trim&&p.value<=0)return;const{value:u}=s.target,r=g(u,s,!0),I=e.trim?r.trim():r,U=I.length!==r.length;d.cancel(),n.value!==I&&m(r,!0,!0),e.trim&&U&&(l.value=l.value+1)},focus:()=>{a.disabled||(_.value=!0)},blur:()=>{a.disabled||(_.value=!1)},forceUpdateKey:l,stateClass:y}},be=(a,{maxRows:i,noAutoShrink:n,rows:e})=>{const l=D(0),b=V(w(()=>R(i)||Number.NaN),{method:"parseInt",nanToZero:!0}),p=V(e,{method:"parseInt",nanToZero:!0}),f=w(()=>Math.max(p.value||2,2)),h=w(()=>Math.max(f.value,b.value||0)),c=w(()=>f.value===h.value?f.value:null),o=async()=>{if(!a.value||!te(a.value)){l.value=null;return}const d=getComputedStyle(a.value),m=Number.parseFloat(d.lineHeight)||1,_=(Number.parseFloat(d.borderTopWidth)||0)+(Number.parseFloat(d.borderBottomWidth)||0),g=(Number.parseFloat(d.paddingTop)||0)+(Number.parseFloat(d.paddingBottom)||0),C=_+g,z=m*f.value+C,F=a.value.style.height||d.height;l.value="auto",await A();const{scrollHeight:S}=a.value;l.value=F,await A();const M=Math.max((S-g)/m,2),s=Math.min(Math.max(M,f.value),h.value),u=Math.max(Math.ceil(s*m+C),z);if(R(n)&&(Number.parseFloat(F.toString())||0)>u){l.value=F;return}l.value=`${u}px`};$(o);const y=w(()=>({resize:"none",height:typeof l.value=="string"?l.value:l.value?`${l.value}px`:void 0}));return{onInput:o,computedStyles:y,computedRows:c}},ye=["id","name","form","value","disabled","placeholder","required","autocomplete","readonly","aria-required","aria-invalid","rows","wrap"],he=L({__name:"BFormTextarea",props:O({noResize:{type:Boolean,default:!1},rows:{default:2},wrap:{default:"soft"},noAutoShrink:{type:Boolean,default:!1},maxRows:{default:void 0},ariaInvalid:{type:[Boolean,String],default:void 0},autocomplete:{default:void 0},autofocus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},form:{default:void 0},formatter:{type:Function,default:void 0},id:{default:void 0},lazyFormatter:{type:Boolean,default:!1},list:{default:void 0},name:{default:void 0},placeholder:{default:void 0},plaintext:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},size:{default:void 0},state:{type:[Boolean,null],default:void 0},debounce:{default:0},debounceMaxWait:{default:Number.NaN}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(a,{expose:i}){const e=Y(a,"BFormTextarea"),[l,b]=J(a,"modelValue",{set:s=>pe(s,b)}),p=Q("_input"),{computedId:f,forceUpdateKey:h,computedAriaInvalid:c,onInput:o,stateClass:y,onChange:d,onBlur:m,focus:_,blur:g}=ve(e,p,l,b),C=w(()=>[y.value,e.plaintext?"form-control-plaintext":"form-control",{[`form-control-${e.size}`]:!!e.size}]),{computedStyles:z,onInput:F,computedRows:S}=be(p,{maxRows:()=>e.maxRows,rows:()=>e.rows,noAutoShrink:()=>e.noAutoShrink}),M=w(()=>({resize:e.noResize?"none":void 0,...e.maxRows||e.noAutoShrink?z.value:void 0}));return i({blur:g,element:p,focus:_}),(s,u)=>(N(),k("textarea",{id:t(f),ref:"_input",key:t(h),class:X(C.value),name:t(e).name||void 0,form:t(e).form||void 0,value:t(l)??void 0,disabled:t(e).disabled,placeholder:t(e).placeholder,required:t(e).required||void 0,autocomplete:t(e).autocomplete||void 0,readonly:t(e).readonly||t(e).plaintext,"aria-required":t(e).required||void 0,"aria-invalid":t(c),rows:t(S)||2,style:ee(M.value),wrap:t(e).wrap||void 0,onInput:u[0]||(u[0]=r=>{t(o)(r),t(F)()}),onChange:u[1]||(u[1]=(...r)=>t(d)&&t(d)(...r)),onBlur:u[2]||(u[2]=(...r)=>t(m)&&t(m)(...r))},null,46,ye))}}),ge={class:"container mt-4 main"},xe={key:0},we={key:0},_e={class:"textAreaTrackBox"},Be={key:1,style:{display:"flex",position:"absolute",top:"20%",left:"32%",right:"32%"}},Ne={class:"alert-heading"},Fe={key:1},De={__name:"TrackB",setup(a){$cookies.get("pscomp_oauth")==null&&(console.log("Not logged in... routing to login page"),ae.push({name:"login"}));const i=D(!0),n=D();let e=!1,l=null,b=me(fe());const p=async()=>{i.value=!1,await A(),i.value=!0},f=async c=>{console.log("File dropped!"),l=c},h=async()=>{var c=new FormData;c.append("file",l);let o={user_id:await b};q.post("/new_submission_track_b",o,{headers:{"content-type":"application/json","Access-Control-Allow-Origin":"*"}}).then(y=>{q.post("/submission_input_save",c,{headers:{"file-name":y.data,track:"B",description:n.value,"Access-Control-Allow-Origin":"*"}})}),e=!0,await p(),console.log("Submission sent to server!")};return(c,o)=>{const y=oe("BLink"),d=P;return N(),k("div",ge,[x("h1",null,[B(t(se),{icon:"database"}),o[1]||(o[1]=v(" Track B Submission ",-1))]),o[8]||(o[8]=x("p",null,[v(" For Track B, a submission consists of the log file "),x("code",null,"arrays.txt"),v(" produced by our instrumented CPython version and a description of how to reproduce the data. ")],-1)),x("p",null,[o[3]||(o[3]=v(" (For more information, see the instructions on the ",-1)),B(y,{to:"/aboutB"},{default:T(()=>[...o[2]||(o[2]=[v("Track B",-1)])]),_:1}),o[4]||(o[4]=v(" page.) ",-1))]),(N(),ne(le,null,{default:T(()=>[i.value?(N(),k("div",xe,[t(e)===!1?(N(),k("div",we,[B(W,{onFileDropped:f}),x("div",_e,[B(t(he),{id:"textarea",modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=m=>n.value=m),placeholder:"Describe how you attained your input.",rows:"3",class:"mt-4"},null,8,["modelValue"]),B(t(ue),{class:"mt-4",onClick:h},{default:T(()=>[...o[5]||(o[5]=[v("Submit",-1)])]),_:1})])])):t(e)===!0?(N(),k("div",Be,[B(t(re),{"model-value":!0,variant:"success"},{default:T(()=>[x("h4",Ne,[B(d),o[6]||(o[6]=v(" Success! ",-1))]),o[7]||(o[7]=x("p",null,[v(" Your submission has been saved successfully! You should momentarily receive an email receipt. "),x("br"),v(" It is now safe to close this page. ")],-1))]),_:1})])):H("",!0)])):t(e)===!0?(N(),k("div",Fe," Processed! ")):H("",!0)]),_:1}))])}}};export{De as default};
