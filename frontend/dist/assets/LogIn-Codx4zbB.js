import{x as c,o as s,z as t,b as n,h as d,w as f,l as m,A as i,p,av as v,q as b,aw as k,ax as w,ab as x}from"./index-CZ5--WV8.js";import{_ as N}from"./BAlert.vue_vue_type_script_setup_true_lang-Bq9xl30a-DQFECoNi.js";import"./BCloseButton.vue_vue_type_script_setup_true_lang-byZmQ_ot-DpvVQpY4.js";const S={class:"container mt-4 main"},C={key:0},O={key:0},$={key:1},T={key:2},G={__name:"LogIn",setup(V){let r=!1;const a=c(!0);let u;$cookies.get("pscomp_oauth")!=null&&(u=$cookies.get("pscomp_oauth").email);const g=async()=>{a.value=!1,await x(),a.value=!0},_=async o=>{console.log("Google login raw response: ",o);const e=k(o.credential);console.log("Google login decoded response: ",e);const h=c(null),y={method:"POST",headers:{"content-type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({id:0,first_name:e.given_name,last_name:e.family_name,email:e.email})};fetch("https://psortcomp.shayandoust.me/logged_in",y).then(l=>l.json()).then(l=>h.value.status=l),console.log("Server replied with: ",o),$cookies.set("pscomp_oauth",JSON.stringify(e)),r=!0,await g(),setTimeout(()=>{w.push({name:"home"})},3e3)};return(o,e)=>(s(),t("div",S,[a.value?(s(),t("div",C,[n(r)===!0?(s(),t("div",O,[d(n(N),{variant:"success","model-value":!0},{default:f(()=>[...e[0]||(e[0]=[p("You have logged in successfully. You will now be redirected to the home page.",-1)])]),_:1})])):m("",!0),e[4]||(e[4]=i("h1",null,"Login",-1)),o.$cookies.get("pscomp_oauth")==null?(s(),t("p",$,[e[1]||(e[1]=p(" In order to upload a submission, you need to log in using a Google account. Your name will be shown on the leaderboard, and you will need the submission receipt emails to claim any prizes. ",-1)),e[2]||(e[2]=i("br",null,null,-1)),e[3]||(e[3]=i("br",null,null,-1)),d(n(v),{callback:_})])):(s(),t("p",T,"You are already logged in as "+b(n(u))+".",1))])):m("",!0)]))}};export{G as default};
